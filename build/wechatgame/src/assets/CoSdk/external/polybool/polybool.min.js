(function e(n,t,r){function o(l,s){if(!t[l]){if(!n[l]){var u="function"==typeof require&&require;if(!s&&u)return u(l,!0);if(i)return i(l,!0);var a=new Error("Cannot find module '"+l+"'");throw a.code="MODULE_NOT_FOUND",a}var c=t[l]={exports:{}};n[l][0].call(c.exports,function(e){var t=n[l][1][e];return o(t||e)},c,c.exports,e,n,t,r)}return t[l].exports}for(var i="function"==typeof require&&require,l=0;l<r.length;l++)o(r[l]);return o})({1:[function(e,n,t){var r,o=e("./lib/build-log"),i=e("./lib/epsilon"),l=e("./lib/intersecter"),s=e("./lib/segment-chainer"),u=e("./lib/segment-selector"),a=e("./lib/geojson"),c=!1,f=i();function g(e,n,t){var o=r.segments(e),i=r.segments(n),l=t(r.combine(o,i));return r.polygon(l)}r={buildLog:function(e){return!0===e?c=o():!1===e&&(c=!1),!1!==c&&c.list},epsilon:function(e){return f.epsilon(e)},segments:function(e){var n=l(!0,f,c);return e.regions.forEach(n.addRegion),{segments:n.calculate(e.inverted),inverted:e.inverted}},combine:function(e,n){return{combined:l(!1,f,c).calculate(e.segments,e.inverted,n.segments,n.inverted),inverted1:e.inverted,inverted2:n.inverted}},selectUnion:function(e){return{segments:u.union(e.combined,c),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:u.intersect(e.combined,c),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:u.difference(e.combined,c),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:u.differenceRev(e.combined,c),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:u.xor(e.combined,c),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:s(e.segments,f,c),inverted:e.inverted}},polygonFromGeoJSON:function(e){return a.toPolygon(r,e)},polygonToGeoJSON:function(e){return a.fromPolygon(r,f,e)},union:function(e,n){return g(e,n,r.selectUnion)},intersect:function(e,n){return g(e,n,r.selectIntersect)},difference:function(e,n){return g(e,n,r.selectDifference)},differenceRev:function(e,n){return g(e,n,r.selectDifferenceRev)},xor:function(e,n){return g(e,n,r.selectXor)}},"object"==typeof window&&(window.PolyBool=r),n.exports=r},{"./lib/build-log":2,"./lib/epsilon":3,"./lib/geojson":4,"./lib/intersecter":5,"./lib/segment-chainer":7,"./lib/segment-selector":8}],2:[function(e,n,t){n.exports=function(){var e,n=0,t=!1;function r(n,t){return e.list.push({type:n,data:t?JSON.parse(JSON.stringify(t)):void 0}),e}return e={list:[],segmentId:function(){return n++},checkIntersection:function(e,n){return r("check",{seg1:e,seg2:n})},segmentChop:function(e,n){return r("div_seg",{seg:e,pt:n}),r("chop",{seg:e,pt:n})},statusRemove:function(e){return r("pop_seg",{seg:e})},segmentUpdate:function(e){return r("seg_update",{seg:e})},segmentNew:function(e,n){return r("new_seg",{seg:e,primary:n})},segmentRemove:function(e){return r("rem_seg",{seg:e})},tempStatus:function(e,n,t){return r("temp_status",{seg:e,above:n,below:t})},rewind:function(e){return r("rewind",{seg:e})},status:function(e,n,t){return r("status",{seg:e,above:n,below:t})},vert:function(n){return n===t?e:(t=n,r("vert",{x:n}))},log:function(e){return"string"!=typeof e&&(e=JSON.stringify(e,!1,"  ")),r("log",{txt:e})},reset:function(){return r("reset")},selected:function(e){return r("selected",{segs:e})},chainStart:function(e){return r("chain_start",{seg:e})},chainRemoveHead:function(e,n){return r("chain_rem_head",{index:e,pt:n})},chainRemoveTail:function(e,n){return r("chain_rem_tail",{index:e,pt:n})},chainNew:function(e,n){return r("chain_new",{pt1:e,pt2:n})},chainMatch:function(e){return r("chain_match",{index:e})},chainClose:function(e){return r("chain_close",{index:e})},chainAddHead:function(e,n){return r("chain_add_head",{index:e,pt:n})},chainAddTail:function(e,n){return r("chain_add_tail",{index:e,pt:n})},chainConnect:function(e,n){return r("chain_con",{index1:e,index2:n})},chainReverse:function(e){return r("chain_rev",{index:e})},chainJoin:function(e,n){return r("chain_join",{index1:e,index2:n})},done:function(){return r("done")}}}},{}],3:[function(e,n,t){n.exports=function(e){"number"!=typeof e&&(e=1e-10);var n={epsilon:function(n){return"number"==typeof n&&(e=n),e},pointAboveOrOnLine:function(n,t,r){var o=t[0],i=t[1],l=r[0],s=r[1],u=n[0];return(l-o)*(n[1]-i)-(s-i)*(u-o)>=-e},pointBetween:function(n,t,r){var o=n[1]-t[1],i=r[0]-t[0],l=n[0]-t[0],s=r[1]-t[1],u=l*i+o*s;return!(u<e||u-(i*i+s*s)>-e)},pointsSameX:function(n,t){return Math.abs(n[0]-t[0])<e},pointsSameY:function(n,t){return Math.abs(n[1]-t[1])<e},pointsSame:function(e,t){return n.pointsSameX(e,t)&&n.pointsSameY(e,t)},pointsCompare:function(e,t){return n.pointsSameX(e,t)?n.pointsSameY(e,t)?0:e[1]<t[1]?-1:1:e[0]<t[0]?-1:1},pointsCollinear:function(n,t,r){var o=n[0]-t[0],i=n[1]-t[1],l=t[0]-r[0],s=t[1]-r[1];return Math.abs(o*s-l*i)<e},linesIntersect:function(n,t,r,o){var i=t[0]-n[0],l=t[1]-n[1],s=o[0]-r[0],u=o[1]-r[1],a=i*u-l*s;if(Math.abs(a)<e)return!1;var c=n[0]-r[0],f=n[1]-r[1],g=(s*f-u*c)/a,d=(i*f-l*c)/a,v={alongA:0,alongB:0,pt:[n[0]+g*i,n[1]+g*l]};return v.alongA=g<=-e?-2:g<e?-1:g-1<=-e?0:g-1<e?1:2,v.alongB=d<=-e?-2:d<e?-1:d-1<=-e?0:d-1<e?1:2,v},pointInsideRegion:function(n,t){for(var r=n[0],o=n[1],i=t[t.length-1][0],l=t[t.length-1][1],s=!1,u=0;u<t.length;u++){var a=t[u][0],c=t[u][1];c-o>e!=l-o>e&&(i-a)*(o-c)/(l-c)+a-r>e&&(s=!s),i=a,l=c}return s}};return n}},{}],4:[function(e,n,t){var r={toPolygon:function(e,n){function t(n){if(n.length<=0)return e.segments({inverted:!1,regions:[]});function t(n){var t=n.slice(0,n.length-1);return e.segments({inverted:!1,regions:[t]})}for(var r=t(n[0]),o=1;o<n.length;o++)r=e.selectDifference(e.combine(r,t(n[o])));return r}if("Polygon"===n.type)return e.polygon(t(n.coordinates));if("MultiPolygon"===n.type){for(var r=e.segments({inverted:!1,regions:[]}),o=0;o<n.coordinates.length;o++)r=e.selectUnion(e.combine(r,t(n.coordinates[o])));return e.polygon(r)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,n,t){function r(e,t){return n.pointInsideRegion([.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])],t)}function o(e){return{region:e,children:[]}}t=e.polygon(e.segments(t));var i=o(null);function l(e,n){for(var t=0;t<e.children.length;t++){if(r(n,(s=e.children[t]).region))return void l(s,n)}var i=o(n);for(t=0;t<e.children.length;t++){var s;r((s=e.children[t]).region,n)&&(i.children.push(s),e.children.splice(t,1),t--)}e.children.push(i)}for(var s=0;s<t.regions.length;s++){var u=t.regions[s];u.length<3||l(i,u)}function a(e,n){for(var t=0,r=e[e.length-1][0],o=e[e.length-1][1],i=[],l=0;l<e.length;l++){var s=e[l][0],u=e[l][1];i.push([s,u]),t+=u*r-s*o,r=s,o=u}return t<0!==n&&i.reverse(),i.push([i[0][0],i[0][1]]),i}var c=[];function f(e){var n=[a(e.region,!1)];c.push(n);for(var t=0;t<e.children.length;t++)n.push(g(e.children[t]))}function g(e){for(var n=0;n<e.children.length;n++)f(e.children[n]);return a(e.region,!0)}for(s=0;s<i.children.length;s++)f(i.children[s]);return c.length<=0?{type:"Polygon",coordinates:[]}:1==c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};n.exports=r},{}],5:[function(e,n,t){var r=e("./linked-list");n.exports=function(e,n,t){function o(e,n){return{id:t?t.segmentId():-1,start:e,end:n,myFill:{above:null,below:null},otherFill:null}}function i(e,n,r){return{id:t?t.segmentId():-1,start:e,end:n,myFill:{above:r.myFill.above,below:r.myFill.below},otherFill:null}}var l=r.create();function s(e,t,r,o,i,l){var s=n.pointsCompare(t,i);return 0!==s?s:n.pointsSame(r,l)?0:e!==o?e?1:-1:n.pointAboveOrOnLine(r,o?i:l,o?l:i)?1:-1}function u(e,n){l.insertBefore(e,function(t){return s(e.isStart,e.pt,n,t.isStart,t.pt,t.other.pt)<0})}function a(e,n){var t=r.node({isStart:!0,pt:e.start,seg:e,primary:n,other:null,status:null});return u(t,e.end),t}function c(e,n,t){var o=r.node({isStart:!1,pt:n.end,seg:n,primary:t,other:e,status:null});e.other=o,u(o,e.pt)}function f(e,n){var t=a(e,n);return c(t,e,n),t}function g(e,n){t&&t.segmentChop(e.seg,n),e.other.remove(),e.seg.end=n,e.other.pt=n,u(e.other,e.pt)}function d(e,n){var t=i(n,e.seg.end,e.seg);return g(e,n),f(t,e.primary)}function v(o,i){var s=r.create();function u(e,t){var r=e.seg.start,o=e.seg.end,i=t.seg.start,l=t.seg.end;return n.pointsCollinear(r,i,l)?n.pointsCollinear(o,i,l)?1:n.pointAboveOrOnLine(o,i,l)?1:-1:n.pointAboveOrOnLine(r,i,l)?1:-1}function a(e){return s.findTransition(function(n){return u(e,n.ev)>0})}function c(e,r){var o=e.seg,i=r.seg,l=o.start,s=o.end,u=i.start,a=i.end;t&&t.checkIntersection(o,i);var c=n.linesIntersect(l,s,u,a);if(!1===c){if(!n.pointsCollinear(l,s,u))return!1;if(n.pointsSame(l,a)||n.pointsSame(s,u))return!1;var f=n.pointsSame(l,u),g=n.pointsSame(s,a);if(f&&g)return r;var v=!f&&n.pointBetween(l,u,a),h=!g&&n.pointBetween(s,u,a);if(f)return h?d(r,s):d(e,a),r;v&&(g||(h?d(r,s):d(e,a)),d(r,l))}else 0===c.alongA&&(-1===c.alongB?d(e,u):0===c.alongB?d(e,c.pt):1===c.alongB&&d(e,a)),0===c.alongB&&(-1===c.alongA?d(r,l):0===c.alongA?d(r,c.pt):1===c.alongA&&d(r,s));return!1}for(var f=[];!l.isEmpty();){var g=l.getHead();if(t&&t.vert(g.pt[0]),g.isStart){t&&t.segmentNew(g.seg,g.primary);var v=a(g),h=v.before?v.before.ev:null,p=v.after?v.after.ev:null;function m(){if(h){var e=c(g,h);if(e)return e}return!!p&&c(g,p)}t&&t.tempStatus(g.seg,!!h&&h.seg,!!p&&p.seg);var b,y,x=m();if(x)e?(y=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below)&&(x.seg.myFill.above=!x.seg.myFill.above):x.seg.otherFill=g.seg.myFill,t&&t.segmentUpdate(x.seg),g.other.remove(),g.remove();if(l.getHead()!==g){t&&t.rewind(g.seg);continue}e?(y=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,g.seg.myFill.below=p?p.seg.myFill.above:o,g.seg.myFill.above=y?!g.seg.myFill.below:g.seg.myFill.below):null===g.seg.otherFill&&(b=p?g.primary===p.primary?p.seg.otherFill.above:p.seg.myFill.above:g.primary?i:o,g.seg.otherFill={above:b,below:b}),t&&t.status(g.seg,!!h&&h.seg,!!p&&p.seg),g.other.status=v.insert(r.node({ev:g}))}else{var w=g.status;if(null===w)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(s.exists(w.prev)&&s.exists(w.next)&&c(w.prev.ev,w.next.ev),t&&t.statusRemove(w.ev.seg),w.remove(),!g.primary){var F=g.seg.myFill;g.seg.myFill=g.seg.otherFill,g.seg.otherFill=F}f.push(g.seg)}l.getHead().remove()}return t&&t.done(),f}return e?{addRegion:function(e){for(var t,r=e[e.length-1],i=0;i<e.length;i++){t=r,r=e[i];var l=n.pointsCompare(t,r);0!==l&&f(o(l<0?t:r,l<0?r:t),!0)}},calculate:function(e){return v(e,!1)}}:{calculate:function(e,n,t,r){return e.forEach(function(e){f(i(e.start,e.end,e),!0)}),t.forEach(function(e){f(i(e.start,e.end,e),!1)}),v(n,r)}}}},{"./linked-list":6}],6:[function(e,n,t){n.exports={create:function(){var e={root:{root:!0,next:null},exists:function(n){return null!==n&&n!==e.root},isEmpty:function(){return null===e.root.next},getHead:function(){return e.root.next},insertBefore:function(n,t){for(var r=e.root,o=e.root.next;null!==o;){if(t(o))return n.prev=o.prev,n.next=o,o.prev.next=n,void(o.prev=n);r=o,o=o.next}r.next=n,n.prev=r,n.next=null},findTransition:function(n){for(var t=e.root,r=e.root.next;null!==r&&!n(r);)t=r,r=r.next;return{before:t===e.root?null:t,after:r,insert:function(e){return e.prev=t,e.next=r,t.next=e,null!==r&&(r.prev=e),e}}}};return e},node:function(e){return e.prev=null,e.next=null,e.remove=function(){e.prev.next=e.next,e.next&&(e.next.prev=e.prev),e.prev=null,e.next=null},e}}},{}],7:[function(e,n,t){n.exports=function(e,n,t){var r=[],o=[];return e.forEach(function(e){var i=e.start,l=e.end;if(n.pointsSame(i,l))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{t&&t.chainStart(e);for(var s={index:0,matches_head:!1,matches_pt1:!1},u={index:0,matches_head:!1,matches_pt1:!1},a=s,c=0;c<r.length;c++){var f=(p=r[c])[0],g=(p[1],p[p.length-1]);if(p[p.length-2],n.pointsSame(f,i)){if(S(c,!0,!0))break}else if(n.pointsSame(f,l)){if(S(c,!0,!1))break}else if(n.pointsSame(g,i)){if(S(c,!1,!0))break}else if(n.pointsSame(g,l)&&S(c,!1,!1))break}if(a===s)return r.push([i,l]),void(t&&t.chainNew(i,l));if(a===u){t&&t.chainMatch(s.index);var d=s.index,v=s.matches_pt1?l:i,h=s.matches_head,p=r[d],m=h?p[0]:p[p.length-1],b=h?p[1]:p[p.length-2],y=h?p[p.length-1]:p[0],x=h?p[p.length-2]:p[1];return n.pointsCollinear(b,m,v)&&(h?(t&&t.chainRemoveHead(s.index,v),p.shift()):(t&&t.chainRemoveTail(s.index,v),p.pop()),m=b),n.pointsSame(y,v)?(r.splice(d,1),n.pointsCollinear(x,y,m)&&(h?(t&&t.chainRemoveTail(s.index,m),p.pop()):(t&&t.chainRemoveHead(s.index,m),p.shift())),t&&t.chainClose(s.index),void o.push(p)):void(h?(t&&t.chainAddHead(s.index,v),p.unshift(v)):(t&&t.chainAddTail(s.index,v),p.push(v)))}var w=s.index,F=u.index;t&&t.chainConnect(w,F);var _=r[w].length<r[F].length;s.matches_head?u.matches_head?_?(R(w),C(w,F)):(R(F),C(F,w)):C(F,w):u.matches_head?C(w,F):_?(R(w),C(F,w)):(R(F),C(w,F))}function S(e,n,t){return a.index=e,a.matches_head=n,a.matches_pt1=t,a===s?(a=u,!1):(a=null,!0)}function R(e){t&&t.chainReverse(e),r[e].reverse()}function C(e,o){var i=r[e],l=r[o],s=i[i.length-1],u=i[i.length-2],a=l[0],c=l[1];n.pointsCollinear(u,s,a)&&(t&&t.chainRemoveTail(e,s),i.pop(),s=u),n.pointsCollinear(s,a,c)&&(t&&t.chainRemoveHead(o,a),l.shift()),t&&t.chainJoin(e,o),r[e]=i.concat(l),r.splice(o,1)}}),o}},{}],8:[function(e,n,t){function r(e,n,t){var r=[];return e.forEach(function(e){var o=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);0!==n[o]&&r.push({id:t?t.segmentId():-1,start:e.start,end:e.end,myFill:{above:1===n[o],below:2===n[o]},otherFill:null})}),t&&t.selected(r),r}var o={union:function(e,n){return r(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],n)},intersect:function(e,n){return r(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],n)},difference:function(e,n){return r(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],n)},differenceRev:function(e,n){return r(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],n)},xor:function(e,n){return r(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],n)}};n.exports=o},{}]},{},[1]);